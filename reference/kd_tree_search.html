<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A kd tree is excellent for locating the points closest or farthest from a
given object. orion supports queries from points, circle/spheres, and
iso_rect/iso_cubes. If a point lies inside the geometry it's distance is 0.
If more points than requested lies inside the geometry a subset of these will
be returned. orion supports approximate queries through the eps argument.
Using it will speed up searches but may return wrong results (but within the
bounds of the given eps)."><title>Locate nearest or farthest points in a tree — kd_tree_search • orion</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Gelasio-0.4.4/font.css" rel="stylesheet"><link href="../deps/Fira_Code-0.4.4/font.css" rel="stylesheet"><link href="../deps/Montserrat-0.4.4/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Locate nearest or farthest points in a tree — kd_tree_search"><meta property="og:description" content="A kd tree is excellent for locating the points closest or farthest from a
given object. orion supports queries from points, circle/spheres, and
iso_rect/iso_cubes. If a point lies inside the geometry it's distance is 0.
If more points than requested lies inside the geometry a subset of these will
be returned. orion supports approximate queries through the eps argument.
Using it will speed up searches but may return wrong results (but within the
bounds of the given eps)."><meta property="og:image" content="https://orion.r-euclid.com/reference/figures/card.png"><meta property="og:image:alt" content="orion: Spatial Searching for euclid"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@thomasp85"><meta name="twitter:site" content="@rstudio"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">orion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-euclid-ecosystem">Euclid ecosystem</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-euclid-ecosystem">
    <h6 class="dropdown-header" data-toc-skip>Foundation</h6>
    <a class="external-link dropdown-item" href="https://r-euclid.com">Euclid</a>
    <a class="external-link dropdown-item" href="https://polyclid.r-euclid.com">Polyclid</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Utilities</h6>
    <a class="dropdown-item" href="https://orion.r-euclid.com">Orion</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/thomasp85/orion/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Locate nearest or farthest points in a tree</h1>
      <small class="dont-index">Source: <a href="https://github.com/thomasp85/orion/blob/HEAD/R/search.R" class="external-link"><code>R/search.R</code></a></small>
      <div class="d-none name"><code>kd_tree_search.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A kd tree is excellent for locating the points closest or farthest from a
given object. orion supports queries from points, circle/spheres, and
iso_rect/iso_cubes. If a point lies inside the geometry it's distance is 0.
If more points than requested lies inside the geometry a subset of these will
be returned. orion supports approximate queries through the <code>eps</code> argument.
Using it will speed up searches but may return wrong results (but within the
bounds of the given <code>eps</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">kd_tree_search</span><span class="op">(</span><span class="va">geometries</span>, <span class="va">tree</span>, <span class="va">n</span>, eps <span class="op">=</span> <span class="fl">0</span>, nearest <span class="op">=</span> <span class="cn">TRUE</span>, sort <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>geometries</dt>
<dd><p>A vector of geometries to use for queries. Either a
<code>euclid_point</code>, <code>euclid_circle2</code>, <code>euclid_sphere</code>, <code>euclid_iso_rect</code>, or
<code>euclid_iso_cube</code> vector. <code>euclid_point_w</code> will get coerced to <code>euclid_point</code>
and <code>euclid_bbox</code> will get coerced to <code>euclid_iso_rect</code>/<code>euclid_iso_cube</code></p></dd>


<dt>tree</dt>
<dd><p>a <code>orion_kd_tree</code></p></dd>


<dt>n</dt>
<dd><p>An integer vector giving the number of points to find per query.
Will recycle to the length of <code>geometries</code></p></dd>


<dt>eps</dt>
<dd><p>Approximation factor for the search. For nearest neighbor the
returned points are no more than <code>1 + eps</code> times farther away than the true
nearest neighbor, whereas for furthest neighbor the returned points are no
less than <code>1/(1 + eps)</code> nearer than the distance to the true match. Will
recycle to the length of <code>geometries</code></p></dd>


<dt>nearest</dt>
<dd><p>Should nearest neighbor be search (setting it to <code>FALSE</code>
results in a furthest neighbor search)</p></dd>


<dt>sort</dt>
<dd><p>Should the returned points be search by their distance to the
query</p></dd>


<dt>...</dt>
<dd><p>Arguments passed on</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with elements <code>points</code> holding a <code>euclid_point</code> vector, <code>id</code></p>


<p>matching the <code>points</code> to the index of <code>geometries</code>, and <code>distance</code> providing
the distance to the query</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other kd tree queries: 
<code><a href="kd_tree_range.html">kd_tree_range</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create a kd tree with points</span></span></span>
<span class="r-in"><span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu">euclid</span><span class="fu">::</span><span class="fu"><a href="https://r-euclid.com/reference/point.html" class="external-link">point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="kd_tree.html">kd_tree</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find furthest neighbor to point</span></span></span>
<span class="r-in"><span><span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu">euclid</span><span class="fu">::</span><span class="fu"><a href="https://r-euclid.com/reference/point.html" class="external-link">point</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">neighbors</span> <span class="op">&lt;-</span> <span class="fu">kd_tree_search</span><span class="op">(</span><span class="va">pt</span>, <span class="va">tree</span>, <span class="fl">10</span>, nearest <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pts</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://r-euclid.com/reference/euclid_plot.html" class="external-link">euclid_plot</a></span><span class="op">(</span><span class="va">neighbors</span><span class="op">$</span><span class="va">points</span>, cex <span class="op">=</span> <span class="fl">0.6</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://r-euclid.com/reference/euclid_plot.html" class="external-link">euclid_plot</a></span><span class="op">(</span><span class="va">pt</span>, cex <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">'green'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="kd_tree_search-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find nearest neighbor to circle</span></span></span>
<span class="r-in"><span><span class="va">circ</span> <span class="op">&lt;-</span> <span class="fu">euclid</span><span class="fu">::</span><span class="fu"><a href="https://r-euclid.com/reference/circle.html" class="external-link">circle</a></span><span class="op">(</span><span class="va">pt</span>, <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">neighbors</span> <span class="op">&lt;-</span> <span class="fu">kd_tree_search</span><span class="op">(</span><span class="va">circ</span>, <span class="va">tree</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pts</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://r-euclid.com/reference/euclid_plot.html" class="external-link">euclid_plot</a></span><span class="op">(</span><span class="va">neighbors</span><span class="op">$</span><span class="va">points</span>, cex <span class="op">=</span> <span class="fl">0.6</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://r-euclid.com/reference/euclid_plot.html" class="external-link">euclid_plot</a></span><span class="op">(</span><span class="va">circ</span>, fg <span class="op">=</span> <span class="st">'green'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="kd_tree_search-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://data-imaginist.com" class="external-link">Thomas Lin Pedersen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

